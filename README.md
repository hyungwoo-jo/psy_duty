# psy_duty — 당직표 생성기

정적 웹앱으로 당직표를 생성/검증/내보내기 합니다. GitHub Pages에서 호스팅하며, 로컬(5174)에서 디버깅 후 곧바로 배포할 수 있습니다.

## 사용 방법
- 기간: 시작일 + (종료일 또는 주 수)
- 근무자 목록: `R연차 이름[, 소아][, 응급]`
- 공휴일: YYYY-MM-DD(줄당 1개), `-YYYY-MM-DD`로 제외
- 개인 불가일: `이름: YYYY-MM-DD, YYYY-MM-DD ...`
- 휴가: `이름: YYYY-MM-DD, ...` → 해당 날짜가 속한 주 전체 제외
- 이전 보정(Stat-to-Pass 입력): 각 사람별 병당/응당/Day-off에 대해 −5..+5
- 생성 → 요약/통계/보정치/당직표 확인 → JSON/CSV/Excel(.xls) 내보내기

## 규칙(핵심)
- 1일 2명: 병당 1, 응당 1 (주말/공휴일 2명, 21h/인)
- 평일 당직 13.5h/인(정규 8h 포함). 다음날 정규 면제(Day-off)
- 주간 상한: 소프트 72h. 자동 재시도 트리거는 70h(최대 5회 재생성)
- 역할/연차 매핑 고정. 응급 back: R3 중 ‘응급’ 태그 1명 고정
- 충원우선모드 없음. 개인 선호도 없음.

### 개인 불가일 처리
- 주말/공휴일 불가일: 그 날 당직 배제
- 평일 불가일: 그 날 당직/정규 제외 + 전날 당직 “강한 선호”를 부여(가능하면 전날 당직으로 해당 평일 Day-off 부여)
- 연차/역할 제약 상 특정 요일만 당직 가능한 경우, 불가일이 무의미할 수 있음(제약 우선)

### 통계/보정치
- 주별 시간 통계(연차 내), 개인별 통계(병당/응당/총당직/Day-off/시간)
- Stat-to-Pass(다음달 보정치): 연차·역할별 여러 명에게 +/− 분배. 이전 보정은 사람/역할별로 먼저 합산 후 재계산
- 병당/응당은 역할별 독립 균형(평균의 floor/ceil). Day-off는 낮은 사람부터 끌어올리는 평균 분배

### 공휴일
- 버튼으로 대한민국 공휴일(기간 내) 불러오기. 실패 시 고정일 대체
- 텍스트에서 `-YYYY-MM-DD`로 제외 가능

### 내보내기
- JSON/CSV/Excel(.xls). Excel은 색상/강조 포함


